<html lang='en'>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset='utf-8'>
<title>ESP Device Setup</title>
<link rel="stylesheet" type="text/css" href="style.css">
<!--script>
beforeSubmit = function()
{
  // assign names to all inputs
  var sensors = document.getElementById("sensors");
  for (var i = 0, s = 0; i < sensors.childNodes.length; i++)
  {
    var sensor = sensors.childNodes[i];
    var npin = 0;
    if (sensor.childNodes.length == 0) continue;
    var sname = "sensor[" + s + "]";
    for (var j = 0; j < sensor.childNodes.length; j++)
    {
      var itm = sensor.childNodes[j];
      if (itm.name == 'name') itm.name = sname + "[name]";
      else if (itm.name == 'type') itm.name = sname + "[type]";
      else if (itm.name == 'pin')
      {
        itm.name = sname + "[pin][" + npin + "]";
        npin++;
      }
    }
    s++;
  }
}
</script-->

</head> 
<body>

<div class="tab">
  <button id='tab_config' class="tablinks" onclick="openTab(event, 'config')">Config</button>
  <button id='tab_file_manager' class="tablinks" onclick="openTab(event, 'file_manager')">File Manager</button>
	<button id='tab_system' class="tablinks" onclick="openTab(event, 'system')">System</button>
</div>

<div id="config" class="tabcontent">

	<fieldset id="field0" class='config'>
		<legend>MODULE</legend>
		<div>
			<label for="module">Module:</label>
			<input name='module' id='module' type='text' required=true/>
		</div>
	</fieldset>

	<fieldset id="field1" class='config'>
		<legend>NETWORK</legend>
		<div>
			<label for="ssid">SSID:</label>
			<input name='ssid' id='ssid' type='text' value='' />
		</div>
		<div>
			<label for="pass">Pass:</label>
			<input name='pass' id='pass' type='text' value='' />
		</div>
		<div>
			<label for="ip">Static IP:</label>
			<input name='ip' id='ip' type='text' value='' />
		</div>
		<div>
			<label for="gateway">Gateway:</label>
			<input name='gateway' id='gateway' type='text' value='' />
		</div>
		<div>
			<label for="apPass">AP Pass:</label>
			<input name='apPass' id='apPass' type='text' value='' />
		</div>
		<div>
			<label for="otaPass">OTA Pass:</label>
			<input name='otaPass' id='otaPass' type='text' value='' />
		</div>
	</fieldset>

	<fieldset id="field2" class='config'>
		<legend>MQTT</legend>
		<div>
			<label for="mqttServer">Server:</label>
			<input name='mqttServer' id='mqttServer' type='text' value='' />
		</div>
		<div>
			<label for="mqttPort">Port:</label>
			<input name='mqttPort' id='mqttPort' type='text' value='' />
		</div>
		<div>
			<label for="mqttUser">User:</label>
			<input name='mqttUser' id='mqttUser' type='text' value='' />
		</div>
		<div>
			<label for="mqttPass">Pass:</label>
			<input name='mqttPass' id='mqttPass' type='text' value='' />
		</div>
	</fieldset>

	<fieldset id="field3">
		<legend>SENSORS
			<input type="text" id='nsensors' value='0' size='2' disabled>
			<input type="button" value='+' id='add_sensor'>
		</legend>       
		<div id='sensors' class='sensors'></div>
	</fieldset>

	<div id='btndiv'>
		<button id='get_config' width="100">Get Config</button> <!-- do not use type='submit' as we use ajax -->
		<button id='set_config' width="100">Set Config</button>
		
		<button id='get_config_json' width="100" onclick="var js=getConfigJson(); document.getElementById('output').value=JSON.stringify(js,null,2);">Get Config Json</button>
		<button id='set_config_json' width="100" onclick="var js=JSON.parse(document.getElementById('output').value); setConfigJson(js);">Set Config Json</button>
	</div>

</div>

<div id="file_manager" class="tabcontent">
	<!-- <button id='filelist' type='button' class='btn btn-primary' width="100">Filelist</button> -->
	<label for="upload">Upload >> </label>
	<input id='upload' type='file' class='btn btn-primary' width="100">
	<div id="tbl_filelist"></div>
</div>

<div id="system" class="tabcontent">
	<button id='restart' idth="100">Restart</button>
	<!-- <button id='reset_wifi' type='button' class='btn btn-primary' width="100">Reset Wifi</button> -->
</div>

<div class="block_container">
	<div id='jsresp'>
		<label for="output"><b>Web response:</b></label>
		<div id='status' style="color:red"></div>
		<textarea id="output" rows="10" cols="90"></textarea>
	</div>
</div>

<script src="espman.js"></script>

</body>
</html>
